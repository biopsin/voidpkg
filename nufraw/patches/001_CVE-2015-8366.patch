--- dcraw.cc	2017-07-22 10:45:08.572109968 +0200
+++ dcraw.cc	2017-07-22 10:46:18.950113433 +0200
@@ -3017,7 +3017,10 @@
       diff = diff ? -diff : 0x80;
     if (ftell(ifp) + 12 >= (int) seg[1][1])
       diff = 0;
-    raw_image[pix] = pred[pix & 1] += diff;
+    if(pix>=raw_width*raw_height)
+      derror();
+    else
+      raw_image[pix] = pred[pix & 1] += diff;
     if (!(pix & 1) && HOLE(pix / raw_width)) pix += 2;
   }
   maximum = 0xff;
